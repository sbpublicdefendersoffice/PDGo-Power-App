# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Training Tracker - View Training Details:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - Container1_3:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            Width: =Parent.Width
          Children:
            - Container3_3:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  Fill: =RGBA(0, 16, 96, 1)
                  FillPortions: =0
                  Height: =92
                  LayoutDirection: =LayoutDirection.Horizontal
                Children:
                  - HomeTitle_3:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =fxTheme.Header.TextColor
                        Font: =Font.Lato
                        Height: =74
                        Size: =26
                        Text: =_currentSelectedTraining.Training
                        Width: =Parent.Width
                        X: =83
                        Y: =127
            - Container4_2:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  FillPortions: =7
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =10
                  LayoutOverflowY: =LayoutOverflow.Scroll
                Children:
                  - Label8:
                      Control: Label@2.5.1
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Text: ="Basic Info"
                        X: =40
                        Y: =40
                  - Container20:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        Fill: =RGBA(237, 237, 237, 1)
                        FillPortions: =0
                        Height: =539
                        RadiusBottomLeft: =25
                        RadiusBottomRight: =25
                        RadiusTopLeft: =25
                        RadiusTopRight: =25
                        Width: =550
                      Children:
                        - Label10:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Host: "
                              Width: =154
                              X: =25
                              Y: =229
                        - Label10_2:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Date: "
                              Width: =154
                              X: =25
                              Y: =90
                        - Label10_3:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              LineHeight: =1.5
                              Size: =17
                              Text: |-
                                ="ðŸ“† " & _currentSelectedTraining.TrainingStartDate & " - " & "ðŸ“† " & _currentSelectedTraining.TrainingEndDay
                              Width: =300
                              X: =180
                              Y: =90
                        - Label10_4:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Type(s): "
                              Width: =154
                              X: =25
                              Y: =300
                        - Label10_5:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =Concat(_currentSelectedTraining.MCLE_Category, Value, ", ")
                              Width: =272
                              X: =180
                              Y: =300
                        - Label10_6:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Format: "
                              Width: =154
                              X: =25
                              Y: =160
                        - Label10_7:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =_currentSelectedTraining.TrainingFormat.Value
                              Width: =355
                              X: =180
                              Y: =160
                        - Label10_8:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Location: "
                              Width: =154
                              X: =25
                              Y: =382
                        - Label10_9:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =If(IsBlank(_currentSelectedTraining.Location), "N/A", _currentSelectedTraining.Location)
                              Width: =355
                              X: =180
                              Y: =382
                        - Label10_14:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Title: "
                              Width: =154
                              X: =25
                              Y: =20
                        - Label10_15:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =_currentSelectedTraining.Training
                              Width: =355
                              X: =180
                              Y: =20
                        - Label10_19:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =If(IsBlank(_currentSelectedTraining.'Training Host'), "N/A", _currentSelectedTraining.'Training Host')
                              Width: =355
                              X: =180
                              Y: =235
                        - Label10_10:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Address: "
                              Width: =154
                              X: =25
                              Y: =449
                        - Label10_11:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Height: =69
                              Size: =17
                              Text: =If(IsBlank(_currentSelectedTraining.Address), "N/A", _currentSelectedTraining.Address)
                              Width: =272
                              X: =180
                              Y: =449
                  - Container9:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =Parent.Height
                        Visible: =false
                        Width: =Parent.Width
                      Children:
                        - BackgroundHeader_4:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(BackgroundHeader_4.Fill, -15%)
                              Color: =RGBA(255,255,255,1)
                              DisabledBorderColor: =ColorFade(BackgroundHeader_4.BorderColor, 70%)
                              DisabledColor: =ColorFade(RGBA(47, 41, 43, 1), 70%)
                              DisabledFill: =ColorFade(RGBA(159, 167, 165, 1), 50%)
                              DisplayMode: =DisplayMode.View
                              Fill: =RGBA(245, 247, 249, 1)
                              FocusedBorderColor: =BackgroundHeader_4.BorderColor
                              FocusedBorderThickness: =0
                              Font: =Font.'Open Sans'
                              Height: =140
                              HoverBorderColor: =ColorFade(BackgroundHeader_4.BorderColor, 20%)
                              HoverColor: =BackgroundHeader_4.Color
                              HoverFill: =ColorFade(BackgroundHeader_4.Fill, 20%)
                              PressedBorderColor: =BackgroundHeader_4.Fill
                              PressedColor: =BackgroundHeader_4.Fill
                              PressedFill: =BackgroundHeader_4.Color
                              RadiusBottomLeft: =20
                              RadiusBottomRight: =20
                              RadiusTopLeft: =20
                              RadiusTopRight: =20
                              Size: =15
                              Text: =""
                              Width: =Parent.Width - 80
                              X: =40
                              Y: =708
                        - Label10_12:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Status: "
                              Width: =141
                              X: =60
                              Y: =714
                        - Label10_13:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =_currentSelectedTrainingStatus
                              Width: =365
                              X: =215
                              Y: =714
                        - Label10_16:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: ="RSVP:"
                              Width: =141
                              X: =60
                              Y: =772
                        - Label10_17:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =If(LookUp(MCLETrainingAttendance, TrainingID = _currentSelectedTraining.ID && Attendee = User().FullName, RSVP), "Yes", "No")
                              Width: =365
                              X: =215
                              Y: =772
                        - Label10_18:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Text: ="Basic Details"
                              Width: =191
                              X: =24
                              Y: =15
                        - Label10_20:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Text: ="Meeting Status"
                              Width: =280
                              X: =24
                              Y: =638
                  - Label8_2:
                      Control: Label@2.5.1
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Text: ="Meeting Information"
                        X: =40
                        Y: =40
                  - Container22:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        Fill: =RGBA(237, 237, 237, 1)
                        FillPortions: =0
                        Height: =180
                        RadiusBottomLeft: =25
                        RadiusBottomRight: =25
                        RadiusTopLeft: =25
                        RadiusTopRight: =25
                        Width: =550
                      Children:
                        - Label10_21:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: |-
                                ="Status: "
                              Width: =141
                              X: =30
                              Y: =25
                        - Label10_22:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =_currentSelectedTrainingStatus
                              Width: =365
                              X: =185
                              Y: =25
                        - Label10_23:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =17
                              Text: ="RSVP:"
                              Width: =141
                              X: =30
                              Y: =83
                        - Label10_24:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Size: =17
                              Text: =If(LookUp(MCLETrainingAttendance, TrainingID = _currentSelectedTraining.ID && Attendee = User().FullName, RSVP), "Yes", "No")
                              Width: =365
                              X: =185
                              Y: =83
                  - Rectangle3:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =40
                  - Container24:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =70
                        Visible: |
                          =true
                      Children:
                        - Button7:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: =Navigate('Training Tracker - Check In', ScreenTransition.Cover);
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Text: ="Check-In"
                              Visible: |-
                                =If(
                                    Label10_13.Text = "In-progress" And Not(LookUp(MCLETrainingAttendance, Attendee = User().FullName And _currentSelectedTraining.ID = TrainingID, Not(IsBlank('Check-InTime')))),
                                    true,
                                    false
                                )
                              Width: |
                                =Parent.Width
                        - Button7_2:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: =If(Label10_17.Text = "Yes", DisplayMode.Disabled, DisplayMode.Edit)
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: |
                                =If(
                                    IsBlank(
                                        LookUp(
                                            MCLETrainingAttendance,
                                            Attendee = User().FullName && _currentSelectedTraining.ID = TrainingID
                                        )
                                    ),
                                    Patch(
                                        MCLETrainingAttendance,
                                        Defaults(MCLETrainingAttendance),
                                        {
                                            Title: _currentSelectedTraining.Training,
                                            RSVP: true,
                                            Attendee: User().FullName,
                                            TrainingID: _currentSelectedTraining.ID
                                        }
                                    );
                                    Office365Outlook.V4CalendarPostItem(
                                        LookUp(
                                            Office365Outlook.CalendarGetTablesV2().value,
                                            name = "Calendar"
                                        ).id,
                                        _currentSelectedTraining.Training,
                                        _currentSelectedTraining.TrainingStartDate,
                                        _currentSelectedTraining.TrainingEndDay,
                                        "Pacific Standard Time",
                                        {location: _currentSelectedTraining.Location & " " & _currentSelectedTraining.Address,
                                        importance: "normal",
                                        isReminderOn: true,
                                        reminder: 60}
                                    );
                                    Navigate(
                                        'Training Tracker - RSVP Success',
                                        ScreenTransition.Cover
                                    );
                                    ,
                                    Notify("You're already enrolled in this course.")
                                );
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Text: ="RSVP"
                              Visible: =If(_currentSelectedTrainingStatus = "In-progress" || _currentSelectedTrainingStatus = "Completed", false, true)
                              Width: =Parent.Width
                        - Button7_1:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              DisplayMode: |-
                                =If(LookUp(
                                        MCLETrainingAttendance,
                                        Attendee = User().FullName And _currentSelectedTraining.ID = TrainingID,
                                        IsBlank('Checkout Time')
                                    ),
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                              Fill: =RGBA(56, 96, 178, 1)
                              Font: =Font.'Open Sans'
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: =Navigate('Training Tracker - Check Out', ScreenTransition.Cover);
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Text: ="Check-Out"
                              Visible: |-
                                =If(
                                    Label10_13.Text = "In-progress" And !IsBlank(LookUp(
                                        MCLETrainingAttendance,
                                        Attendee = User().FullName && TrainingID = _currentSelectedTraining.ID,
                                        'Check-InTime'
                                    )),
                                    true,
                                    false
                                )
                              Width: =Parent.Width
                  - Rectangle4:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Fill: =RGBA(0, 0, 0, 0)
                        X: =40
                        Y: =40
                  - Training Details - Show All Attendees Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =RGBA(255, 255, 255, 1)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(56, 96, 178, 1)
                        Font: =Font.'Open Sans'
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Navigate('Training Tracker - Attendee List', ScreenTransition.Cover, {Training: _currentSelectedTraining})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Show Attendees"
                        Visible: ="Training Administrator" in ForAll(UserRecord.Capabilities, Value)
                        Width: =500
                  - Training Details - Generate Certificates Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =ColorFade(Self.Fill, -15%)
                        Color: =RGBA(255, 255, 255, 1)
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        Fill: =RGBA(56, 96, 178, 1)
                        Font: =Font.'Open Sans'
                        HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                        OnSelect: |-
                          =Navigate('Training Tracker - MCLE Certificate Chooser Single', ScreenTransition.Cover, {Training: _currentSelectedTraining})
                        PressedBorderColor: =Self.Fill
                        PressedColor: =Self.Fill
                        PressedFill: =Self.Color
                        Text: ="Generate Certificates"
                        Visible: ="Training Certificates" in ForAll(UserRecord.Capabilities, Value)
                        Width: =500
      - Back Button_16:
          Control: Classic/Icon@2.5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =fxTheme.Header.TextColor
            Height: =fxTheme.Header.IconSize
            Icon: =Icon.ArrowLeft
            OnSelect: =Back()
            Width: =fxTheme.Header.IconSize
            X: =30
            Y: =Container3_3.Height / 2 - 21
