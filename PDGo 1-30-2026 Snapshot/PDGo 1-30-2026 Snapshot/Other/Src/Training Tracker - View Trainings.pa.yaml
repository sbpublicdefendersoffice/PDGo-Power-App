# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Training Tracker - View Trainings:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |+
        =If(IsBlank(_userDomain),
            UpdateContext({_showLoading: true});
            Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email)));
            Set(_dateSelected, Today());
            Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days));
            Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
            Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
        );
        Set(_calendarVisibles, false);
        UpdateContext({_showLoading: true});




        Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
        ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2("Calendar"  , Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
        ClearCollect(FilteredTrainingEvents, Filter(MyCalendarEvents, StartsWith(Lower(Subject), "training")));
        UpdateContext({_showLoading: false});
        Set(_calendarVisible, true);


        UpdateContext({_showFilter: false});

        Refresh(MCLETrainings);

    Children:
      - Container1_1:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            Width: =Parent.Width
          Children:
            - Container3_1:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(0, 16, 96, 1)
                  LayoutDirection: =LayoutDirection.Horizontal
                Children:
                  - HomeTitle_2:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(0, 18, 107, 1)
                        Color: =fxTheme.Header.TextColor
                        Font: =Font.Lato
                        Height: =74
                        Size: =26
                        Text: ="My Trainings"
                        Width: =Parent.Width
                        X: =83
                        Y: =127
            - Container4_1:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  FillPortions: =7
                  LayoutDirection: =LayoutDirection.Vertical
                Children:
                  - Container13:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =RGBA(0, 16, 96, 1)
                        FillPortions: =2
                        Visible: =_showFilter
                      Children:
                        - Icon10:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(255, 255, 255, 1)
                              Height: =32
                              Icon: =Icon.Search
                              Width: =32
                              X: =36
                              Y: =45
                        - TextInput1:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              AccessibleLabel: ="search keywords for your training"
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Default: =""
                              Font: =Font.'Open Sans'
                              Height: =50
                              HintText: ="Search Trainings"
                              HoverBorderColor: =RGBA(0, 18, 107, 1)
                              HoverFill: =RGBA(186, 202, 226, 1)
                              Width: =Parent.Width - 120
                              X: =80
                              Y: =36
                        - Label13:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(255, 255, 255, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Height: =68
                              Text: ="Status"
                              Width: =103
                              X: =36
                              Y: =100
                        - Label13_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(255, 255, 255, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Height: =68
                              Text: ="Format"
                              Width: =123
                              X: =Parent.Width / 2 + 25
                              Y: =100
                        - Icon11:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =RGBA(255, 255, 255, 1)
                              Height: =59
                              Icon: =Icon.Reset
                              OnSelect: =Reset(ComboBox3_1);Reset(ComboBox3)
                              PaddingLeft: =10
                              Width: =50
                              X: =590
                              Y: =95
                        - ComboBox3:
                            Control: Classic/ComboBox@2.4.0
                            Properties:
                              AccessibleLabel: |-
                                ="drop down box to select satus. Options are: In-Progress, Completed. Cancelled."
                              BorderColor: =RGBA(0, 18, 107, 1)
                              ChevronBackground: =RGBA(56, 96, 178, 1)
                              ChevronFill: =RGBA(255, 255, 255, 1)
                              ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              ChevronHoverFill: =RGBA(255, 255, 255, 1)
                              DisplayFields: =["Value"]
                              Font: =Font.'Open Sans'
                              Height: =57
                              HoverFill: =RGBA(186, 202, 226, 1)
                              InputTextPlaceholder: =""
                              IsSearchable: =false
                              Items: =Choices(MCLETrainings.TrainingStatus)
                              NoSelectionText: ="All"
                              PressedColor: =RGBA(255, 255, 255, 1)
                              PressedFill: =RGBA(0, 18, 107, 1)
                              SearchFields: =["Value"]
                              SelectMultiple: =false
                              SelectionColor: =RGBA(255, 255, 255, 1)
                              SelectionFill: =RGBA(56, 96, 178, 1)
                              Width: =Parent.Width / 2.5
                              X: =36
                              Y: =168
                        - ComboBox3_1:
                            Control: Classic/ComboBox@2.4.0
                            Properties:
                              AccessibleLabel: |-
                                ="Format drop box. Options are: In-person, Online, Hybrid "
                              BorderColor: =RGBA(0, 18, 107, 1)
                              ChevronBackground: =RGBA(56, 96, 178, 1)
                              ChevronFill: =RGBA(255, 255, 255, 1)
                              ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              ChevronHoverFill: =RGBA(255, 255, 255, 1)
                              DisplayFields: =["Value"]
                              Font: =Font.'Open Sans'
                              Height: =57
                              HoverFill: =RGBA(186, 202, 226, 1)
                              InputTextPlaceholder: =""
                              IsSearchable: =false
                              Items: =Choices(MCLETrainings.TrainingFormat)
                              NoSelectionText: ="All"
                              PressedColor: =RGBA(255, 255, 255, 1)
                              PressedFill: =RGBA(0, 18, 107, 1)
                              SearchFields: =["Value"]
                              SelectMultiple: =false
                              SelectionColor: =RGBA(255, 255, 255, 1)
                              SelectionFill: =RGBA(56, 96, 178, 1)
                              Width: =Parent.Width / 2.5
                              X: =Parent.Width / 2 + 30
                              Y: =168
                  - Gallery6:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        FillPortions: =6
                        Items: "=With(\n    {\n        filteredByInputAndFormat: Filter(\n            MCLETrainings, \n            StartsWith(Training, TextInput1.Text) &&\n            (IsBlank(ComboBox3_1.Selected.Value) || IsEmpty(ComboBox3_1.SelectedItems) || TrainingFormat.Value = ComboBox3_1.Selected.Value)\n        )\n    },\n    Sort(\n        If(\n            IsBlank(ComboBox3.Selected.Value),\n            filteredByInputAndFormat, \n            ComboBox3.Selected.Value = \"In-progress\",\n            Filter(filteredByInputAndFormat, TrainingStatus.Value <> \"In-Progress\" && (Now() >= TrainingStartDate && Now() <= TrainingEndDay)),\n            ComboBox3.Selected.Value = \"Available\",\n            Filter(filteredByInputAndFormat, TrainingStatus.Value <> \"Available\" && Now() < TrainingStartDate),\n            ComboBox3.Selected.Value = \"Completed\",\n            Filter(filteredByInputAndFormat, TrainingStatus.Value <> \"Completed\" && Now() > TrainingEndDay),\n            ComboBox3.Selected.Value = \"Cancelled\",\n            Filter(filteredByInputAndFormat, TrainingStatus.Value = \"Cancelled\" && Now() < TrainingStartDate)\n        ), Now() >= TrainingStartDate\n    )\n)  "
                        TemplatePadding: =20
                        TemplateSize: =200
                        Visible: =trainingsListView
                      Children:
                        - Rectangle6:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Fill: =RGBA(241, 244, 249, 1)
                              Height: =199
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =1
                        - Subtitle1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =43
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0
                              PaddingLeft: =0
                              PaddingRight: =0
                              PaddingTop: =0
                              Size: =24
                              Text: =ThisItem.Training
                              VerticalAlign: =VerticalAlign.Top
                              Width: =395
                              Wrap: =false
                              X: =39
                              Y: =20
                        - NextArrow1:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              AccessibleLabel: =Self.Tooltip
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(166, 166, 166, 1)
                              DisabledBorderColor: =RGBA(56, 56, 56, 1)
                              DisabledColor: =RGBA(119, 119, 119, 1)
                              Height: =50
                              Icon: =Icon.ChevronRight
                              OnSelect: =Select(Parent)
                              PaddingBottom: =16
                              PaddingLeft: =16
                              PaddingRight: =16
                              PaddingTop: =16
                              Tooltip: ="View item details"
                              Width: =50
                              X: =Parent.TemplateWidth - Self.Width - 12
                              Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                        - CourseDate:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =37
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0.00
                              PaddingLeft: =0.00
                              PaddingRight: =0.00
                              PaddingTop: =0.00
                              Size: =18
                              Text: |-
                                ="ðŸ“† " & ThisItem.TrainingStartDate
                              VerticalAlign: =VerticalAlign.Top
                              Width: =499
                              X: =39
                              Y: =75
                        - CourseFormat:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: =Switch(ThisItem.TrainingFormat.Value, "Online", Color.LightGreen, "In-person", Color.LightBlue, "Hybrid", Color.DarkSalmon)
                              Font: =Font.'Open Sans'
                              Height: =30
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: =Select(Parent)
                              PaddingBottom: =3.51
                              PaddingLeft: =3.51
                              PaddingRight: =3.50
                              PaddingTop: =3.50
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =16
                              Text: =ThisItem.TrainingFormat.Value
                              Width: =127.31
                              X: =39
                              Y: =112
                        - CourseStatus:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Switch(CourseStatus.Text, "Available", Color.Blue, "Completed", Color.Green, "In-progress", Color.Orange)
                              Font: =Font.'Open Sans'
                              Height: =23.14
                              OnSelect: =Select(Parent)
                              PaddingBottom: =3.51
                              PaddingLeft: =3.51
                              PaddingRight: =3.50
                              PaddingTop: =3.50
                              Size: =16
                              Text: |
                                =If(
                                    Now() < ThisItem.TrainingStartDate && Not("Available" = ThisItem.TrainingStatus.Value), 
                                    "Cancelled",
                                    Now() < ThisItem.TrainingStartDate, 
                                    "Available", 
                                    Now() >= ThisItem.TrainingStartDate && Now() <= ThisItem.TrainingEndDay, 
                                    "In-progress", 
                                    Now() > ThisItem.TrainingEndDay, 
                                    "Completed"
                                )
                              Width: =137.10
                              X: =Parent.Width - 260
                              Y: =112
                        - CoursePresenter:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =25
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0.00
                              PaddingLeft: =0.00
                              PaddingRight: =0.00
                              PaddingTop: =0.00
                              Size: =14
                              Text: |-
                                ="Presenter:    " & ThisItem.'Training Host'
                              VerticalAlign: =VerticalAlign.Top
                              Width: =279
                              X: =39
                              Y: =157
                        - CourseID:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =25
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0.00
                              PaddingLeft: =0.00
                              PaddingRight: =0.00
                              PaddingTop: =0.00
                              Size: =14
                              Text: |-
                                ="ID:    " & ThisItem.ID
                              VerticalAlign: =VerticalAlign.Top
                              Width: =159
                              X: =Parent.Width - 260
                              Y: =157
                        - RSVPLabel:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Right
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Height: =23.14
                              OnSelect: =Select(Parent)
                              PaddingBottom: =3.51
                              PaddingLeft: =3.51
                              PaddingRight: =3.50
                              PaddingTop: =3.50
                              Size: =18
                              Text: ="* RSVP'd"
                              Visible: =If(LookUp(MCLETrainingAttendance, TrainingID = ThisItem.ID && Attendee = User().FullName, RSVP), true, false)
                              Width: =137.10
                              X: =Parent.Width - 210
                              Y: =30
                        - Button6:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: =Color.Transparent
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 0.1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 0.1), -20%)
                              OnSelect: |-
                                =Set(_currentSelectedTraining, ThisItem);
                                Navigate('Training Tracker - View Training Details', ScreenTransition.Cover);

                                If(Now() < _currentSelectedTraining.TrainingStartDate, Set(_currentSelectedTrainingStatus, "Available"), Now() > _currentSelectedTraining.TrainingStartDate && Now() < _currentSelectedTraining.TrainingEndDay, Set(_currentSelectedTrainingStatus, "In-progress"), Now() > _currentSelectedTraining.TrainingEndDay, Set(_currentSelectedTrainingStatus, "Completed"))
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Text: =""
                              Width: =Parent.TemplateWidth
                  - Container8:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        FillPortions: =3
                        Visible: =trainingsCalendarView
                      Children:
                        - CalendarCont_3:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Height: =496
                              Width: =Parent.Width
                            Children:
                              - LblMonthSelected3_4:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Font: =Font.Lato
                                    Height: =64
                                    Text: =Text(_firstDayOfMonth, "mmmm yyyy")
                                    Visible: =!_calendarVisibles
                                    Width: =Parent.Width
                                    Wrap: =false
                                    Y: =
                              - iconPrevMonth3_4:
                                  Control: Classic/Icon@2.5.0
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Color: =RGBA(0, 18, 107, 1)
                                    Icon: =Icon.ChevronLeft
                                    OnSelect: "=/*changes month view to previous month*/\n           \nSet(_firstDayOfMonth, DateAdd(_firstDayOfMonth, -1, TimeUnit.Months));           \nSet(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));           \nSet(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));           \n/*collects calendar events for all days in current month view. Updates _minDate to prevent duplicate data collection if user returns to this month view*/           \nIf(_minDate > _firstDayOfMonth,           \n Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(\"Calendar\", Text(_firstDayInView, DateTimeFormat.UTC), Text(DateAdd(_minDate, -1, TimeUnit.Days), DateTimeFormat.UTC)).value);           \n Set(_minDate, _firstDayInView))"
                                    PaddingBottom: =10
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =10
                                    TabIndex: =0
                                    Tooltip: ="View previous month"
                                    Visible: =_calendarVisible
                                    Width: =91
                                    Y: =
                              - iconNextMonth3_4:
                                  Control: Classic/Icon@2.5.0
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Color: =RGBA(0, 18, 107, 1)
                                    Icon: =Icon.ChevronRight
                                    OnSelect: "=/*changes month view to next month*/\n           \nSet(_firstDayOfMonth, DateAdd(_firstDayOfMonth, 1, TimeUnit.Months));           \nSet(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));           \n/*collects calendar events for all days in current month view. Updates _maxDate to prevent duplicate data collection if user returns to this month view*/           \nSet(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));           \nIf(_maxDate < _lastDayOfMonth,           \n Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(\"Calendar\", Text(DateAdd(_maxDate, 1, TimeUnit.Days), DateTimeFormat.UTC), DateAdd(_firstDayInView, 40, TimeUnit.Days)).value);           \n Set(_maxDate, DateAdd(_firstDayInView, 40, TimeUnit.Days)))"
                                    PaddingBottom: =10
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =10
                                    TabIndex: =0
                                    Tooltip: ="View next month"
                                    Visible: =_calendarVisible
                                    Width: =91
                                    X: =Parent.Width - Self.Width
                                    Y: =
                              - RectCalendarEventsHeader3_4:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Fill: =RGBA(240, 240, 240, 1)
                                    Height: =LblCalendarEventsHeader3_4.Height
                                    Visible: =_calendarVisible
                                    Width: =LblCalendarEventsHeader3_4.Width
                                    X: =LblCalendarEventsHeader3_4.X
                                    Y: =442
                              - LblCalendarEventsHeader3_4:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Font: =Font.Lato
                                    Height: =52
                                    PaddingLeft: =30
                                    Text: =Text(_dateSelected, DateTimeFormat.LongDate)
                                    Visible: =_calendarVisible
                                    Width: =Parent.Width
                                    Wrap: =false
                                    Y: =442
                              - MonthDayGallery3_3:
                                  Control: Gallery@2.15.0
                                  Variant: MonthDayGallery
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Height: =329
                                    Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
                                    TemplatePadding: =0
                                    TemplateSize: =65
                                    Visible: |
                                      =_calendarVisible
                                    Width: =Parent.Width
                                    X: =0
                                    Y: =113
                                  Children:
                                    - Circle4_3:
                                        Control: Circle@2.3.0
                                        Properties:
                                          BorderColor: =RGBA(0, 18, 107, 1)
                                          Fill: =Switch(CourseStatus_1.Text, "Available", Color.Blue, "Completed", Color.Green, "In-progress", Color.Orange, RGBA(205, 220, 245, 1))
                                          Height: =Self.Width
                                          OnSelect: =Select(Parent)
                                          Visible: |-
                                            =CountRows(Filter(MyCalendarEvents, 
                                                DateValue(Start) = DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days) 
                                                && !Subcircle3_3.Visible && Title9_3.Visible))
                                          Width: =6.5
                                          X: =MonthDayGallery3_3.TemplateWidth / 2 - Self.Width / 2
                                          Y: =MonthDayGallery3_3.TemplateHeight * (0.75)
                                    - Subcircle3_3:
                                        Control: Circle@2.3.0
                                        Properties:
                                          BorderColor: =RGBA(0, 18, 107, 1)
                                          Fill: =Switch(CourseStatus_1.Text, "Available", Color.Blue, "Completed", Color.Green, "In-progress", Color.Orange, RGBA(205, 220, 245, 1))
                                          Height: =3 * Title9_3.Size
                                          OnSelect: =Select(Parent)
                                          Visible: =And(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, Title9_3.Visible)
                                          Width: =Self.Height
                                          X: =MonthDayGallery3_3.TemplateWidth/2 - Self.Width/2
                                          Y: =MonthDayGallery3_3.TemplateHeight / 2 - Self.Height / 2
                                    - Title9_3:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 0)
                                          Color: =If(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(255, 255, 255, 1), DateAdd(_firstDayInView, ThisItem.Value) = Today(), RGBA(47, 41, 43, 1), LblMonthSelected3.Color)
                                          Fill: |-
                                            =/*Fill value changes if the gallery item day = today, or if it lies outside of the current month*/             
                                            If(
                                                /*Date selected is today*/
                                                DateAdd(_firstDayInView, ThisItem.Value) = Today() && DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(0,0,0,0),
                                                /*Today when it is not selected*/
                                                DateAdd(_firstDayInView, ThisItem.Value) = Today(), ColorFade(Subcircle3_3.Fill, 0.67), 
                                                /*The day is outside the range of the currently selected month*/
                                                Abs(Self.Text - ThisItem.Value) > 10,RGBA(200, 200, 200, 0.3), RGBA(0, 0, 0, 0))
                                          FocusedBorderColor: =Self.Color
                                          FocusedBorderThickness: =2
                                          Font: =Font.Lato
                                          Height: =65
                                          OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                                          Size: =17 * MonthDayGallery3_3.TemplateWidth / 91
                                          TabIndex: =0
                                          Text: =Day(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days))
                                          Visible: |-
                                            =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                                             !(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days)) + 1 > _lastDayOfMonth)
                                          Width: =Parent.Width / 7
                                          Wrap: =false
                        - WeekTitleCont_2:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Height: =47
                              Width: =Parent.Width
                              Y: =64
                            Children:
                              - WeekdayGallery3_5:
                                  Control: Gallery@2.15.0
                                  Variant: WeekdayGallery
                                  Properties:
                                    BorderColor: =RGBA(0, 18, 107, 1)
                                    Height: =45
                                    Items: =Calendar.WeekdaysShort()
                                    TemplatePadding: =0
                                    TemplateSize: =91
                                    Visible: =_calendarVisible
                                    Width: =Parent.Width
                                    X: =0
                                    Y: =2
                                  Children:
                                    - Title8_5:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          BorderColor: =RGBA(0, 0, 0, 1)
                                          Font: =Font.Lato
                                          Height: =WeekdayGallery3_5.TemplateHeight
                                          OnSelect: =Select(Parent)
                                          Size: =17 * WeekdayGallery3_5.TemplateWidth / 77
                                          Text: =ThisItem.Value
                                          Width: =Parent.Width / 7
                                          Wrap: =false
                                          Y: =WeekdayGallery3_5.TemplateHeight / 2 - Self.Height / 2
                  - Gallery6_1:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                      Properties:
                        BorderColor: =RGBA(0, 18, 107, 1)
                        FillPortions: =3
                        Items: |-
                          =/*Sort(
                              Filter(
                                  MCLETrainings,
                                  StartsWith(
                                      Training,
                                      TextInput1.Text
                                  ),
                                  IsBlank(ComboBox3_1.Selected.Value) || IsEmpty(ComboBox3_1.SelectedItems) || TrainingFormat.Value = ComboBox3_1.Selected.Value,
                                  Text(TrainingStartDate, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)
                              ),
                              Now() > TrainingStartDate
                          )*/
                          MCLETrainings
                          // SortByColumns(Filter(MyCalendarEvents, Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)), "Start")
                        LayoutMinHeight: =350
                        TemplatePadding: =20
                        TemplateSize: =200
                        Visible: =false
                      Children:
                        - Rectangle6_1:
                            Control: Rectangle@2.3.0
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Fill: =RGBA(241, 244, 249, 1)
                              Height: =199
                              OnSelect: =Select(Parent)
                              Width: =Parent.TemplateWidth
                              Y: =1
                        - Subtitle1_2:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =43
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0
                              PaddingLeft: =0
                              PaddingRight: =0
                              PaddingTop: =0
                              Size: =24
                              Text: =ThisItem.Training
                              VerticalAlign: =VerticalAlign.Top
                              Width: =395
                              Wrap: =false
                              X: =39
                              Y: =20
                        - NextArrow1_1:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              AccessibleLabel: =Self.Tooltip
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Color: =RGBA(166, 166, 166, 1)
                              DisabledBorderColor: =RGBA(56, 56, 56, 1)
                              DisabledColor: =RGBA(119, 119, 119, 1)
                              Height: =50
                              Icon: =Icon.ChevronRight
                              OnSelect: =Select(Parent)
                              PaddingBottom: =16
                              PaddingLeft: =16
                              PaddingRight: =16
                              PaddingTop: =16
                              Tooltip: ="View item details"
                              Width: =50
                              X: =Parent.TemplateWidth - Self.Width - 12
                              Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                        - CourseDate_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =37
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0.00
                              PaddingLeft: =0.00
                              PaddingRight: =0.00
                              PaddingTop: =0.00
                              Size: =18
                              Text: |-
                                ="ðŸ“† " & ThisItem.TrainingStartDate
                              VerticalAlign: =VerticalAlign.Top
                              Width: =499
                              X: =39
                              Y: =75
                        - CourseFormat_1:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: =Switch(ThisItem.TrainingFormat.Value, "Online", Color.LightGreen, "In-person", Color.LightBlue, "Hybrid", Color.DarkSalmon)
                              Font: =Font.'Open Sans'
                              Height: =26.65
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                              OnSelect: =Select(Parent)
                              PaddingBottom: =3.51
                              PaddingLeft: =3.51
                              PaddingRight: =3.50
                              PaddingTop: =3.50
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Size: =12
                              Text: =ThisItem.TrainingFormat.Value
                              Width: =127.31
                              X: =39
                              Y: =112
                        - CourseStatus_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Color: =Switch(CourseStatus_1.Text, "Available", Color.Blue, "Completed", Color.Green, "In-progress", Color.Orange)
                              Font: =Font.'Open Sans'
                              Height: =23.14
                              OnSelect: =Select(Parent)
                              PaddingBottom: =3.51
                              PaddingLeft: =3.51
                              PaddingRight: =3.50
                              PaddingTop: =3.50
                              Size: =16
                              Text: =If(Now() < ThisItem.TrainingStartDate, "Available", Now() >= ThisItem.TrainingStartDate And Now() <= ThisItem.TrainingEndDay, "In-progress", Now() > ThisItem.TrainingEndDay, "Completed")
                              Width: =137.10
                              X: =Parent.Width - 260
                              Y: =112
                        - CoursePresenter_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =25
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0.00
                              PaddingLeft: =0.00
                              PaddingRight: =0.00
                              PaddingTop: =0.00
                              Size: =14
                              Text: |-
                                ="Presenter:    " & ThisItem.'Training Host'
                              VerticalAlign: =VerticalAlign.Top
                              Width: =279
                              X: =39
                              Y: =157
                        - CourseID_1:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                              Height: =25
                              OnSelect: =Select(Parent)
                              PaddingBottom: =0.00
                              PaddingLeft: =0.00
                              PaddingRight: =0.00
                              PaddingTop: =0.00
                              Size: =14
                              Text: |-
                                ="ID:    " & ThisItem.ID
                              VerticalAlign: =VerticalAlign.Top
                              Width: =159
                              X: =Parent.Width - 260
                              Y: =157
                        - Button6_1:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =ColorFade(Self.Fill, -15%)
                              Color: =RGBA(255, 255, 255, 1)
                              DisabledBorderColor: =RGBA(166, 166, 166, 1)
                              Fill: =Color.Transparent
                              Font: =Font.'Open Sans'
                              Height: =Parent.TemplateHeight
                              HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
                              HoverColor: =RGBA(255, 255, 255, 0.1)
                              HoverFill: =ColorFade(RGBA(56, 96, 178, 0.1), -20%)
                              OnSelect: |-
                                =Set(_currentSelectedTraining, ThisItem);
                                Navigate('Training Tracker - View Training Details', ScreenTransition.CoverRight);

                                If(Now() < _currentSelectedTraining.TrainingStartDate, Set(_currentSelectedTrainingStatus, "Available"), Now() > _currentSelectedTraining.TrainingStartDate && Now() < _currentSelectedTraining.TrainingEndDay, Set(_currentSelectedTrainingStatus, "In-progress"), Now() > _currentSelectedTraining.TrainingEndDay, Set(_currentSelectedTrainingStatus, "Completed"))
                              PressedBorderColor: =Self.Fill
                              PressedColor: =Self.Fill
                              PressedFill: =Self.Color
                              Text: =""
                              Width: =Parent.TemplateWidth
                        - RSVPLabel_1:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Right
                              BorderColor: =RGBA(0, 18, 107, 1)
                              Font: =Font.'Open Sans'
                              Height: =23.14
                              OnSelect: =Select(Parent)
                              PaddingBottom: =3.51
                              PaddingLeft: =3.51
                              PaddingRight: =3.50
                              PaddingTop: =3.50
                              Size: =18
                              Text: ="* RSVP'd"
                              Visible: =If(LookUp(MCLETrainingAttendance, TrainingID = ThisItem.ID && Attendee = User().FullName, RSVP), true, false)
                              Width: =137.10
                              X: =Parent.Width - 210
                              Y: =30
      - Back Button_12:
          Control: Classic/Icon@2.5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =fxTheme.Header.TextColor
            Height: =fxTheme.Header.IconSize
            Icon: =Icon.ArrowLeft
            OnSelect: '=Back() '
            Width: =fxTheme.Header.IconSize
            X: =30
            Y: =Container3_1.Height / 2 - 21
      - Back Button_13:
          Control: Classic/Icon@2.5.0
          Properties:
            AccessibleLabel: ="filter icon "
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =fxTheme.Header.TextColor
            Height: =fxTheme.Header.IconSize
            Icon: =Icon.Filter
            OnSelect: |-
              =UpdateContext({_showFilter: !_showFilter});
            Width: =fxTheme.Header.IconSize
            X: =Parent.Width - 80
            Y: =Container3_1.Height / 2 - 21
      - Back Button_14:
          Control: Classic/Icon@2.5.0
          Properties:
            AccessibleLabel: ="calendar icon to view the trainings in the calendar. Press it again to see the list view"
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =fxTheme.Header.TextColor
            Height: =fxTheme.Header.IconSize
            Icon: =Icon.CalendarBlank
            OnSelect: |-
              =Set(trainingsCalendarView, true);
              Set(trainingsListView, false);

              If(IsBlank(_userDomain),         
              	UpdateContext({_showLoading: true});         
              	Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email)));         
              	Set(_dateSelected, Today());         
              	Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days));         
              	Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));         
              	Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))         
              );         
              Set(_calendarVisible, false);         
              UpdateContext({_showLoading: true});         
              Set(_myCalendar, Last(FirstN(Office365Outlook.CalendarGetTables().value, 3)));         
              Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));         
              Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));         
              ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);         
              UpdateContext({_showLoading: false});         
              Set(_calendarVisible, true)
            Visible: =trainingsListView
            Width: =fxTheme.Header.IconSize
            X: =Parent.Width - 140
            Y: =Container3_1.Height / 2 - 21
      - Back Button_15:
          Control: Classic/Icon@2.5.0
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(255, 255, 255, 1)
            Height: =43
            Icon: =Icon.ListScrollWatchlist
            OnSelect: |-
              =Set(trainingsCalendarView, false);
              Set(trainingsListView, true);
            Visible: =trainingsCalendarView
            Width: =40
            X: =Parent.Width - 140
            Y: =Container3_1.Height / 2 - 21
