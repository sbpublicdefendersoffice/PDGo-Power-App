# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Finalize Meeting:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
      OnVisible: |-
        =UpdateContext({teamsInfo:
        {
            CalendarID: Blank(),
            Subject: Blank(),
            EventMessageContent: Blank(),
            TimeZone: Text(Now(),DateTimeZone.UTC),
            StartTime: Blank(),
            EndTime: Blank()
        }})
    Children:
      - Dropdown1:
          Control: Classic/DropDown@2.3.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            ChevronBackground: =RGBA(56, 96, 178, 1)
            ChevronFill: =RGBA(255, 255, 255, 1)
            ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            ChevronHoverFill: =RGBA(255, 255, 255, 1)
            Default: ="Calendar"
            Font: =Font.'Open Sans'
            HoverFill: =RGBA(186, 202, 226, 1)
            Items: =Office365Outlook.CalendarGetTablesV2().value
            Items.Value: =name
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 18, 107, 1)
            SelectionColor: =RGBA(255, 255, 255, 1)
            SelectionFill: =RGBA(56, 96, 178, 1)
            X: =40
            Y: =40
      - TextInput3:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =""
            Font: =Font.'Open Sans'
            HintText: ="Subject"
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Width: =575
            X: =40
            Y: =181
      - TextInput3_1:
          Control: Classic/TextInput@2.3.2
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            Default: =""
            Font: =Font.'Open Sans'
            Height: =319
            HintText: ="Event Content"
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverFill: =RGBA(186, 202, 226, 1)
            Mode: =TextMode.MultiLine
            Width: =575
            X: =40
            Y: =279
      - Dropdown2:
          Control: Classic/DropDown@2.3.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            ChevronBackground: =RGBA(56, 96, 178, 1)
            ChevronFill: =RGBA(255, 255, 255, 1)
            ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            ChevronHoverFill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            HoverFill: =RGBA(186, 202, 226, 1)
            Items: =Sequence(12,1)
            Items.Value: =Value
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 18, 107, 1)
            SelectionColor: =RGBA(255, 255, 255, 1)
            SelectionFill: =RGBA(56, 96, 178, 1)
            Width: =108
            X: =40
            Y: =626
      - Dropdown2_1:
          Control: Classic/DropDown@2.3.1
          Properties:
            BorderColor: =RGBA(0, 18, 107, 1)
            ChevronBackground: =RGBA(56, 96, 178, 1)
            ChevronFill: =RGBA(255, 255, 255, 1)
            ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            ChevronHoverFill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            HoverFill: =RGBA(186, 202, 226, 1)
            Items: =Sequence(60,00)
            Items.Value: =Value
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 18, 107, 1)
            SelectionColor: =RGBA(255, 255, 255, 1)
            SelectionFill: =RGBA(56, 96, 178, 1)
            Width: =108
            X: =191
            Y: =626
      - Button16:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Self.Fill, -15%)
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(56, 96, 178, 1)
            Font: =Font.'Open Sans'
            HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
            OnSelect: |-
              =UpdateContext({teamsInfo:
              {
                  CalendarID: Dropdown1.Selected.id,
                  Subject: TextInput3.Text,
                  EventMessageContent: TextInput3_1.Text,
                  TimeZone: Text(Now(),DateTimeZone.UTC),
                  StartTime: DateAdd(Now(),1,TimeUnit.Days),
                  EndTime: DateAdd(DateAdd(Now(),1,TimeUnit.Hours),1,TimeUnit.Days)
              }});
              MicrosoftTeams.CreateTeamsMeeting(teamsInfo.CalendarID,teamsInfo.Subject,{content:"Meeting Content", contentType:"html"},"Pacific Standard Time",{dateTime: teamsInfo.StartTime},{dateTime: teamsInfo.EndTime},true,"teamsForBusiness",{requiredAttendees:"mperez@countyofsb.org; bmodell@countyofsb.org"});
            PressedBorderColor: =Self.Fill
            PressedColor: =Self.Fill
            PressedFill: =Self.Color
            X: =187
            Y: =788
